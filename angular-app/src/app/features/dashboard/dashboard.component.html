<div class="min-h-screen bg-gradient-to-br from-base-200 via-base-100 to-base-200">
  <!-- Gradient Header with Glass Effect -->
  <header class="bg-gradient-to-r from-primary to-secondary p-6 shadow-lg relative overflow-hidden">
    <!-- Animated background pattern -->
    <div class="absolute inset-0 opacity-10">
      <div class="absolute top-0 left-0 w-64 h-64 bg-white rounded-full blur-3xl -translate-x-1/2 -translate-y-1/2">
      </div>
      <div class="absolute bottom-0 right-0 w-64 h-64 bg-white rounded-full blur-3xl translate-x-1/2 translate-y-1/2">
      </div>
    </div>

    <div class="relative flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
      <div class="flex items-center gap-4">
        <div class="p-4 bg-white/20 backdrop-blur-sm rounded-2xl shadow-xl">
          <span class="material-icons text-4xl text-white">dashboard</span>
        </div>
        <div>
          <h1 class="text-3xl font-bold text-white mb-1">Dashboard</h1>
          <p class="text-white/90 text-sm">Your spending overview</p>
        </div>
      </div>

      <!-- Period Selector -->
      <select class="select select-bordered bg-white/20 backdrop-blur-sm text-white border-white/30 w-full md:w-auto"
        [ngModel]="selectedPeriod()" (ngModelChange)="onPeriodChange($event)">
        @for (period of periods; track period.value) {
        <option [value]="period.value" class="text-base-content">{{ period.label }}</option>
        }
      </select>
    </div>
  </header>

  <div class="p-4 space-y-6">

    @if (isLoading()) {
    <div class="flex flex-col items-center justify-center py-20 space-y-4">
      <span class="loading loading-spinner loading-lg text-primary"></span>
      <p class="text-base-content/60">Loading dashboard...</p>
    </div>
    } @else {
    <!-- Summary Cards -->
    @if (receiptCount() > 0) {
    <div class="grid grid-cols-2 lg:grid-cols-4 gap-3 md:gap-4">
      <!-- Total Spent -->
      <div class="stats shadow bg-base-100">
        <div class="stat p-3 md:p-4">
          <div class="stat-figure text-primary hidden md:block">
            <span class="material-icons text-3xl">attach_money</span>
          </div>
          <div class="stat-title text-xs md:text-sm">Total Spent</div>
          <div class="stat-value text-primary text-lg md:text-2xl">{{ totalSpent() | myr }}</div>
          <div class="stat-desc text-xs hidden md:block">For selected period</div>
        </div>
      </div>

      <!-- Receipts -->
      <div class="stats shadow bg-base-100">
        <div class="stat p-3 md:p-4">
          <div class="stat-figure text-secondary hidden md:block">
            <span class="material-icons text-3xl">receipt</span>
          </div>
          <div class="stat-title text-xs md:text-sm">Receipts</div>
          <div class="stat-value text-secondary text-lg md:text-2xl">{{ receiptCount() }}</div>
          <div class="stat-desc text-xs hidden md:block">Total scanned</div>
        </div>
      </div>

      <!-- Average -->
      <div class="stats shadow bg-base-100">
        <div class="stat p-3 md:p-4">
          <div class="stat-figure text-accent hidden md:block">
            <span class="material-icons text-3xl">show_chart</span>
          </div>
          <div class="stat-title text-xs md:text-sm">Average</div>
          <div class="stat-value text-accent text-lg md:text-2xl">{{ averagePerReceipt() | myr }}</div>
          <div class="stat-desc text-xs hidden md:block">Per receipt</div>
        </div>
      </div>

      <!-- Top Store -->
      <div class="stats shadow bg-base-100">
        <div class="stat p-3 md:p-4">
          <div class="stat-figure text-info hidden md:block">
            <span class="material-icons text-3xl">store</span>
          </div>
          <div class="stat-title text-xs md:text-sm">Top Store</div>
          <div class="stat-value text-info text-lg md:text-xl truncate" [title]="topStore()">{{ topStore() }}</div>
          <div class="stat-desc text-xs hidden md:block">Most frequent</div>
        </div>
      </div>
    </div>
    }

    <!-- Charts (always visible) -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
      <!-- Spending Over Time Chart -->
      <div class="card bg-base-100 shadow-xl lg:col-span-2">
        <div class="card-body p-4 md:p-8">
          <h2 class="card-title flex items-center gap-2 text-base md:text-xl">
            <span class="material-icons text-primary">timeline</span>
            Spending Over Time
          </h2>
          <div class="h-[250px] md:h-[300px] w-full relative">
            <canvas #spendingChart></canvas>
          </div>
        </div>
      </div>

      <!-- Spending by Store Chart -->
      <div class="card bg-base-100 shadow-xl">
        <div class="card-body p-4 md:p-8">
          <h2 class="card-title flex items-center gap-2 text-base md:text-xl">
            <span class="material-icons text-secondary">pie_chart</span>
            Top 5 Stores
          </h2>
          <div class="h-[250px] md:h-[300px] w-full relative">
            <canvas #storeChart></canvas>
          </div>
        </div>
      </div>

      <!-- Monthly Comparison Chart (Hidden on mobile) -->
      <div class="card bg-base-100 shadow-xl hidden lg:block">
        <div class="card-body p-4 md:p-8">
          <h2 class="card-title flex items-center gap-2 text-base md:text-xl">
            <span class="material-icons text-accent">bar_chart</span>
            Monthly Comparison
          </h2>
          <div class="h-[250px] md:h-[300px] w-full relative">
            <canvas #monthlyChart></canvas>
          </div>
        </div>
      </div>
    </div>

    @if (receiptCount() === 0) {
    <div class="hero bg-base-200 rounded-box p-8 mt-8">
      <div class="hero-content text-center">
        <div class="max-w-md">
          <span class="material-icons text-6xl text-base-content/20 mb-4">receipt_long</span>
          <h1 class="text-2xl font-bold">No receipts yet</h1>
          <p class="py-6">Start scanning your receipts to see your spending insights here.</p>
        </div>
      </div>
    </div>
    }
    }
  </div>